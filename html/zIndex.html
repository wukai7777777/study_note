<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<style>
  .modal {
    position: fixed;
    left: 0;
    right: 0;
    top: 0;
    bottom: 0;
    background-color: rgba(0,0,0, 0.1);
    border: 1px solid red;
    z-index: 1001;
  }
  .droppable {
    position: fixed;
    left: 50%;
    top: 50%;
    width: 100px;
    height: 100px;
    border: 1px solid red;
    background: yellow;
    z-index: 10000;
  }
</style>
<body>
  <div>
    <div class="modal">

    </div>
  </div>

  <div class="droppable"></div>
</body>

<script>
  const data = [
  [
    "主题",
    "业务模块",
    "指标名称",
    "指标含义",
    "指标口径",
  ],
  [
    "售前服务成交分析",
    "关键指标分析",
    "成交量",
    "指定商品的购买成交量，不论购买了几个商品，就算成交",
    "{是否达成销售}=1的数据量之和，可根据{售前咨询后达成销售的天数}进行查询，x范围在1-7",
  ],
  [
    "售前服务成交分析",
    "关键指标分析",
    "成交量差异",
    "成交量的差值",
    "本期成交量-上期成交量；目标周期成交量-对标周期成交量",
  ],
  [
    "售前服务成交分析",
    "关键指标分析",
    "成交量变化率",
    "成交量的差异率",
    "本期成交量-上期成交量）/上期成交量；（目标周期成交量-对标周期成交量）/对标周期成交量",
  ],
  [
    "售前服务成交分析",
    "关键指标分析",
    "成交率",
    "指定商品的购买成交率",
    "成交量/总咨询量，总咨询量={意图ID}的去重计数",
  ],
  [
    "售前服务成交分析",
    "关键指标分析",
    "成交率差异",
    "成交率的差值",
    "本期成交率-上期成交率；目标周期成交率-对标周期成交率",
  ],
  [
    "售前服务成交分析",
    "关键指标分析",
    "成交率变化率",
    "成交率的差异率",
    "本期成交率-上期成交率）/上期成交率；（目标周期成交率-对标周期成交量）/对标周期成交率",
  ],
  [
    "售前服务成交分析",
    "热度商品探索",
    "成交量",
    "指定商品的购买成交量，不论购买了几个商品，就算成交。",
    "{是否达成销售}=1的数据量之和",
  ],
  [
    "售前服务成交分析",
    "热度商品探索",
    "成交量占比",
    "在不同商品分析颗粒度下的成交量份额",
    "当前维度的各个字段值对应的成交量/成交量",
  ],
  [
    "售前服务成交分析",
    "热度商品探索",
    "成交量差异",
    "成交量的差值",
    "本期成交量-上期成交量；目标周期成交量-对标周期成交量",
  ],
  [
    "售前服务成交分析",
    "热度商品探索",
    "成交量变化率",
    "成交量的差异率",
    "（本期成交量-上期成交量）/上期成交量；（目标周期成交量-对标周期成交量）/对标周期成交量",
  ],
  [
    "售前服务成交分析",
    "热度商品探索",
    "成交率",
    "指定商品的购买成交率",
    "成交量/总咨询量，总咨询量={意图ID}的去重计数",
  ],
  [
    "售前服务成交分析",
    "热度商品探索",
    "成交率差异",
    "成交率的差值",
    "本期成交率-上期成交率；目标周期成交率-对标周期成交率",
  ],
  [
    "售前服务成交分析",
    "热度商品探索",
    "成交率变化率",
    "成交率的差异率",
    "（本期成交率-上期成交率）/上期成交率；（目标周期成交率-对标周期成交量）/对标周期成交率",
  ],
  [
    "售前服务成交分析",
    "目标商品分析",
    "服务咨询量",
    "不同的意图id去重数量",
    "{意图ID}的去重计数",
  ],
  [
    "售前服务成交分析",
    "目标商品分析",
    "成交率",
    "指定商品的购买成交率",
    "成交量/总咨询量，总咨询量={意图ID}的去重计数",
  ],
  [
    "售前服务成交分析",
    "目标商品分析",
    "成交率差异",
    "成交率的差值",
    "本期成交率-上期成交率；目标周期成交率-对标周期成交率",
  ],
  [
    "售前服务成交分析",
    "目标商品分析",
    "成交率指数",
    "各个细分人群中的成交率，除以整体人群中的相应比例",
    "各个细分人群中的成交率，除以整体人群中的相应比例",
  ],
  [
    "售前服务成交分析",
    "问题环节探索",
    "服务体验不满意的比例",
    "服务体验得分为1-2分的比例",
    "{客户服务低满意度}的平均值",
  ],
  [
    "售前服务成交分析",
    "问题环节探索",
    "服务咨询量",
    "不同的意图id去重数量",
    "{意图ID}的去重计数",
  ],
  [
    "售前服务成交分析",
    "问题环节探索",
    "服务环节重要性指数",
    "综合考虑服务咨询量与体验对转化的驱动力",
    "(({本期服务咨询量}   - AVG({本期服务咨询量}) OVER ()) / STDDEV_SAMP({本期服务咨询量}) OVER () + 3) *   {服务体验对成交转化的驱动力}",
  ],
  [
    "售前服务成交分析",
    "目标环节服务改善",
    "首解率",
    "客户问题被解决的比例",
    "{是否首解}=1的平均值",
  ],
  [
    "售前服务成交分析",
    "目标环节服务改善",
    "会话回合数量",
    "客户询问与客服回复消息回合数量",
    "{会话回合数量}求和",
  ],
  [
    "售前服务成交分析",
    "目标环节服务改善",
    "单次会话平均时长（秒）",
    "客户咨询问题以及客服回复的平均会话时长",
    "{单次会话平均时长（秒）}平均值",
  ],
  [
    "售前服务成交分析",
    "目标环节服务改善",
    "平均回复响应时长（秒）",
    "客户回复问题的平均会话时长",
    "{平均回复响应时长（秒）}平均值",
  ],
  [
    "售前服务成交分析",
    "目标环节服务改善",
    "多人处理率",
    "解决客户咨询问题的客服人数超过1人的比例",
    "{是否多人处理}=1的平均值",
  ],
  [
    "售前服务成交分析",
    "目标环节服务改善",
    "升级率",
    "解决客户咨询问题时升级处理的比例",
    "{是否升级}=1的平均值",
  ],
  [
    "售前服务成交分析",
    "目标环节服务改善",
    "完整处理周期（小时）",
    "解决客户咨询问题的整个处理时长",
    "{完整处理周期（分钟）}平均值",
  ],
  [
    "售前服务成交分析",
    "目标环节服务改善",
    "对目标服务环节体验的驱动力",
    "服务指标对服务体验的贡献度",
    "各个服务指标的值与{客户服务高满意度}的相关性结果",
  ],
  [
    "售前服务成交分析",
    "目标环节服务改善",
    "服务体验",
    "不同维度的服务体验得分为4-5分的比例",
    "{客户服务高满意度}的平均值",
  ],
  [
    "售前服务成交分析",
    "目标环节服务改善",
    "服务体验排名",
    "不同维度的服务体验得分为4-5分的比例排名",
    "{客户服务高满意度}的平均值排名结果",
  ],
];

function mergeCell() {
  const mergedData = [];
  data.forEach((ele, i) => {
    const mergedRow = [];
    const rows = data[i];
    if (i === 0) {
      mergedData.push(rows);
    } else {
      rows.forEach((unit, j) => {
        if (data[i-1][j] === rows[j]) { // 上一行跟当前行相同 置成 空字符
          mergedRow.push('');
        } else {
          mergedRow.push(rows[j]);
        }
      });
      mergedData.push(mergedRow);
    }
  });

  return mergedData;
}

console.log('wukai----', mergeCell());
</script>
</html>